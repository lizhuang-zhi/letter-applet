"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transition=void 0;var utils_1=require("../common/utils"),getClassNames=function(e){return{enter:"van-"+e+"-enter van-"+e+"-enter-active enter-class enter-active-class","enter-to":"van-"+e+"-enter-to van-"+e+"-enter-active enter-to-class enter-active-class",leave:"van-"+e+"-leave van-"+e+"-leave-active leave-class leave-active-class","leave-to":"van-"+e+"-leave-to van-"+e+"-leave-active leave-to-class leave-active-class"}},nextTick=function(){return new Promise(function(e){return setTimeout(e,1e3/30)})};exports.transition=function(e){return Behavior({properties:{customStyle:String,show:{type:Boolean,value:e,observer:"observeShow"},duration:{type:null,value:300,observer:"observeDuration"},name:{type:String,value:"fade"}},data:{type:"",inited:!1,display:!1},methods:{observeShow:function(e,t){e!==t&&(e?this.enter():this.leave())},enter:function(){var e=this,t=this.data,n=t.duration,t=t.name,a=getClassNames(t),s=utils_1.isObj(n)?n.enter:n;this.status="enter",this.$emit("before-enter"),Promise.resolve().then(nextTick).then(function(){e.checkStatus("enter"),e.$emit("enter"),e.setData({inited:!0,display:!0,classes:a.enter,currentDuration:s})}).then(nextTick).then(function(){e.checkStatus("enter"),e.transitionEnded=!1,e.setData({classes:a["enter-to"]})}).catch(function(){})},leave:function(){var e,t,n,a,s=this;this.data.display&&(e=(t=this.data).duration,t=t.name,n=getClassNames(t),a=utils_1.isObj(e)?e.leave:e,this.status="leave",this.$emit("before-leave"),Promise.resolve().then(nextTick).then(function(){s.checkStatus("leave"),s.$emit("leave"),s.setData({classes:n.leave,currentDuration:a})}).then(nextTick).then(function(){s.checkStatus("leave"),s.transitionEnded=!1,setTimeout(function(){return s.onTransitionEnd()},a),s.setData({classes:n["leave-to"]})}).catch(function(){}))},checkStatus:function(e){if(e!==this.status)throw new Error("incongruent status: "+e)},onTransitionEnd:function(){var e,t;this.transitionEnded||(this.transitionEnded=!0,this.$emit("after-"+this.status),e=(t=this.data).show,t=t.display,!e&&t&&this.setData({display:!1}))}}})};